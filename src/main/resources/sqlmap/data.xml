<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="data">
     <select id="selectBase" parameterType="paramMap" resultType="resultMap">
        SELECT 
        	* 
        FROM 
        	TEST_GEOCMS_SETTING 
    </select>
    
    <update id="updateBase" parameterType="paramMap">
    	UPDATE
    		TEST_GEOCMS_SETTING
    	SET
    		 CONTENTTAB 		= '${contentTab}'
    		,CONTENTTABTYPE 	= '${contentTabType}'
    		,BOARDTAB 			= '${boardTab}'
    		,CONTENTNUM 		= '${contentNum}'
    		,BOARDNUM 			= '${boardNum}'
    		,OPENAPI			= '${openAPI}'
    		,LATESTVIEW			= '${latestView}'
    		,MAPZOOM 			= '${mapZoom}'
    </update>
    
    <update id="updateTabNameBoard" parameterType="paramMap">
    	UPDATE
    		TEST_BOARD_CONTENT
    	SET
    		TABNAME 		= '${newTabName}'
    	WHERE
    		TABNAME			= '${oldTabName}'
    </update>
    
    <update id="updateTabNameImage" parameterType="paramMap">
    	UPDATE
    		TEST_IMAGE_CONTENT
    	SET
    		TABNAME 		= '${newTabName}'
    	WHERE
    		TABNAME			= '${oldTabName}'
    </update>
    
    <update id="updateTabNameVideo" parameterType="paramMap">
    	UPDATE
    		TEST_VIDEO_CONTENT
    	SET
    		TABNAME 		= '${newTabName}'
    	WHERE
    		TABNAME			= '${oldTabName}'
    </update>
    
    <select id="selectBoardList" parameterType="paramMap" resultType="resultMap">
	    SELECT 
			 ID
        	,TITLE
        	,CONTENT
        	,FILENAME
        	,FILEPATH
        	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
        	,UDATE
        	,IDX
        	,TABNAME
        	,NULL AS LATITUDE
		   	,NULL AS LONGITUDE
		    ,NULL AS THUMBNAIL
		    ,NULL AS ORIGINNAME
		    ,'GeoCMS' AS DATAKIND
        	,SHARETYPE
		FROM 
			TEST_BOARD_CONTENT
		WHERE
			1 = 1
		AND
	    	(
	    		ID = '${loginId}'
	    	<if test="myContent == null || (myContent != null and !myContent.equalsIgnoreCase('Y'))">
	    	OR 
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			'${loginId}' IN 
	    			(
	    				SELECT 
	    					ID 
	    				FROM 
	    					TEST_GEOCMS_SHARE 
	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
	    				WHERE 
	    					SHAREKIND = 'GeoCMS' 
	    				AND
	    					SHAREIDX = TEST_BOARD_CONTENT.IDX
	    			)
	    		)
	    	 </if>
	    	)
	    	
			<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All') and type != null and !type.equalsIgnoreCase('latest')">
				AND
					TABNAME = '${tabName}'
			</if>	
			<if test="idx != null">
		 		AND
		 			IDX = ${idx}
			</if>
		 
		 	<choose>
				<when test="pageNum != null and pageNum.equalsIgnoreCase('1')">
					ORDER BY UDATE DESC LIMIT ${contentNum}
				</when>
				<when test="orderIdx != null">
					ORDER BY IDX DESC LIMIT ${orderIdx}
				</when>
				<when test="pageNum != null and !pageNum.equalsIgnoreCase('1')">
					ORDER BY UDATE DESC LIMIT ${contentNum} OFFSET ${offset}
				</when>
				<when test="contentNum != null">
					ORDER BY IDX DESC LIMIT ${contentNum}
				</when>
			</choose>
    </select>
    
    <select id="selectBoardListLen" parameterType="paramMap" resultType="resultMap">
	    SELECT 
			COUNT(*) TOTAL_CNT
		FROM 
			TEST_BOARD_CONTENT
		WHERE
			1 = 1
		AND
	    	(
	    		ID = '${loginId}'
	    	<if test="myContent == null || (myContent != null and !myContent.equalsIgnoreCase('Y'))">
	    	OR 
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			'${loginId}' IN 
	    			(
	    				SELECT 
	    					ID 
	    				FROM 
	    					TEST_GEOCMS_SHARE 
	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
	    				WHERE 
	    					SHAREKIND = 'GeoCMS' 
	    				AND
	    					SHAREIDX = TEST_BOARD_CONTENT.IDX
	    			)
	    		)
	    	 </if>
	    	)
		<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All')">
			AND
				TABNAME = '${tabName}'
		</if>
    </select>
    
    <insert id="insertBoard" parameterType="paramMap" useGeneratedKeys="true" keyProperty="idx">
        INSERT INTO TEST_BOARD_CONTENT
        (
        	 ID
        	,TITLE
        	,CONTENT
        	,FILENAME
        	,FILEPATH
        	,UDATE
        	,TABNAME
        	,SHARETYPE
        )
        VALUES
        (
        	 '${loginId}'
        	,'${title}'
        	,'${content}'
        	,'${files}'
        	,'${filePath}'
        	, NOW()
        	,'${tabName}'
        	, ${shareType}
        )
        <selectKey keyProperty="idx" resultType="int" order="AFTER">
        	SELECT LAST_INSERT_ID()
   		</selectKey>
    </insert>
    
    <update id="updateBoard" parameterType="paramMap">
    	UPDATE
    		TEST_BOARD_CONTENT
    	SET
    		 ID 		= '${loginId}'
    		,TITLE 		= '${title}'
    		,CONTENT 	= '${content}'
    		,FILENAME	= '${files}'
    		,FILEPATH	= '${filePath}'
    		,UDATE 		= NOW()
    		,TABNAME 	= '${tabName}'
    		,SHARETYPE 	=  ${shareType}
    	WHERE 
    		1 = 1
    	AND
    		IDX = ${idx}
    </update>
    
    <delete id="deleteBoard">
    	DELETE
    		FROM
    			TEST_BOARD_CONTENT
    		WHERE
    			IDX = ${idx}
    		AND
    			ID = '${loginId}'
    </delete>
    
    <select id="selectContentList" parameterType="paramMap" resultType="resultMap">
	    SELECT
	    	*
	    FROM
	    	(
			    SELECT
			    	 ID
			    	,TITLE
			    	,CONTENT
			    	,FILENAME
			    	,FILEPATH
			    	,UDATE
			    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
			    	,IDX
			    	,TABNAME
			    	,LATITUDE
			    	,LONGITUDE
			    	,NULL AS THUMBNAIL
			    	,NULL AS ORIGINNAME
			    	,'GeoPhoto' AS DATAKIND
			    	,SHARETYPE
			    	,PROJECTIDX
			    	,(SELECT id FROM test_project_content WHERE test_project_content.idx = TEST_IMAGE_CONTENT.PROJECTIDX) projectUserId
			    FROM
			    	TEST_IMAGE_CONTENT
				UNION
			    SELECT
			    	 ID
			    	,TITLE
			    	,CONTENT
			    	,FILENAME
			    	,FILEPATH
			    	,UDATE
			    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
			    	,IDX
			    	,TABNAME
			    	,LATITUDE
			    	,LONGITUDE
			    	,THUMBNAIL
			    	,ORIGINNAME
			    	,'GeoVideo' AS DATAKIND
			    	,SHARETYPE
			    	,PROJECTIDX
			    	,(SELECT id FROM test_project_content WHERE test_project_content.idx = TEST_VIDEO_CONTENT.PROJECTIDX) projectUserId
			    FROM
			    	TEST_VIDEO_CONTENT
			) TEST_CONTENT
			
		    WHERE
		    	1 = 1
		    AND
	    	(
	    		ID = '${loginId}'
	    	<if test="myContentMarker == null">
	    	OR 
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			(
						'${loginId}' IN
						(
		    				SELECT 
		    					ID 
		    				FROM 
		    					TEST_GEOCMS_SHARE 
		    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
		    				WHERE 
		    					SHAREKIND IN('GeoPhoto', 'GeoVideo') 
		    				AND  
		    					SHAREIDX = TEST_CONTENT.IDX
						)
					OR
						'${loginId}' IN
						(SELECT ID FROM TEST_PROJECT_CONTENT WHERE IDX = TEST_CONTENT.PROJECTIDX)
	    			)
	    		)
	    	 </if>
	    	)
	    	<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All') and type != null and !type.equalsIgnoreCase('latest')">
				AND
					TABNAME = '${tabName}'
			</if>
			<if test="type != null and type.equalsIgnoreCase('marker')">
				AND 
		 			LATITUDE IS NOT NULL 
		 		AND  
		 			LONGITUDE IS NOT NULL
		 		AND 
		 			LATITUDE != 0
		 		AND 
		 			LONGITUDE != 0
		 	</if>
		 	
		 	<choose>
		 		<when test="(pageNum != null and pageNum == 1) or(type != null and type.equalsIgnoreCase('latest'))">
					ORDER BY UDATE DESC LIMIT ${contentNum}
				</when>
				<when test="type != null and (!type.equalsIgnoreCase('marker') and !type.equalsIgnoreCase('one'))">
					ORDER BY UDATE DESC LIMIT ${contentNum} OFFSET ${offset}
				</when>
		 	</choose>
    </select>
    
    <select id="selectContentListLen" parameterType="paramMap" resultType="resultMap">
    	SELECT
    		COUNT(*) TOTAL_CNT
    	FROM
    		(
			    SELECT
			    	 ID
			    	,TITLE
			    	,CONTENT
			    	,FILENAME
			    	,FILEPATH
			    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
			    	,IDX
			    	,TABNAME
			    	,LATITUDE
			    	,LONGITUDE
			    	,NULL AS THUMBNAIL
			    	,NULL AS ORIGINNAME
			    	,'GeoPhoto' AS DATAKIND
			    	,SHARETYPE
			    	,PROJECTIDX
			    FROM
			    	TEST_IMAGE_CONTENT
				UNION
			    SELECT
			    	 ID
			    	,TITLE
			    	,CONTENT
			    	,FILENAME
			    	,FILEPATH
			    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
			    	,IDX
			    	,TABNAME
			    	,LATITUDE
			    	,LONGITUDE
			    	,THUMBNAIL
			    	,ORIGINNAME
			    	,'GeoVideo' AS DATAKIND
			    	,SHARETYPE
			    	,PROJECTIDX
			    FROM
			    	TEST_VIDEO_CONTENT
			) TEST_CONTENT
			
		    WHERE
		    	1 = 1
		    AND
	    	(
	    		ID = '${loginId}'
	    	<if test="myContentMarker == null">
	    	OR 
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			(
						'${loginId}' IN
						(
		    				SELECT 
		    					ID 
		    				FROM 
		    					TEST_GEOCMS_SHARE 
		    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
		    				WHERE 
		    					SHAREKIND IN('GeoPhoto', 'GeoVideo') 
		    				AND  
		    					SHAREIDX = TEST_CONTENT.IDX
						)
					OR
						'${loginId}' IN
						(SELECT ID FROM TEST_PROJECT_CONTENT WHERE IDX = TEST_CONTENT.PROJECTIDX)
	    			)
	    		)
	    	 </if>
	    	)
	    	<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All') and type != null and !type.equalsIgnoreCase('latest')">
				AND
					TABNAME = '${tabName}'
			</if>
    </select>
    
    <select id="selectImageList" parameterType="paramMap" resultType="resultMap">
		SELECT 
			 ID
			,TITLE
			,CONTENT
			,FILENAME
			,FILEPATH
			,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
			,UDATE
			,IDX
			,TABNAME
			,LATITUDE
			,LONGITUDE
			,NULL AS THUMBNAIL
			,NULL AS ORIGINNAME
			,'GeoPhoto' AS DATAKIND
			,SHARETYPE
		FROM 
			TEST_IMAGE_CONTENT
		WHERE
			1 = 1
		AND
	    	(	
	    		ID = '${loginId}'
	    	<if test="myContent == null || (myContent != null and !myContent.equalsIgnoreCase('Y'))">
	    	OR
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			(
						'${loginId}' IN
						(
		    				SELECT 
		    					ID 
		    				FROM 
		    					TEST_GEOCMS_SHARE 
		    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
		    				WHERE 
		    					SHAREKIND IN('GeoPhoto') 
		    				AND  
		    					SHAREIDX = TEST_IMAGE_CONTENT.IDX
						)
					OR
						'${loginId}' IN
						(SELECT ID FROM TEST_PROJECT_CONTENT WHERE IDX = TEST_IMAGE_CONTENT.PROJECTIDX)
	    			)
	    		)
	    	 </if>
	    	)
	    	
			<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All') and type != null and !type.equalsIgnoreCase('latest')">
				AND
					TABNAME = '${tabName}'
			</if>
			<if test="type != null and type.equalsIgnoreCase('marker')">
				AND 
		 			LATITUDE IS NOT NULL 
		 		AND  
		 			LONGITUDE IS NOT NULL
		 		AND 
		 			LATITUDE != 0
		 		AND 
		 			LONGITUDE != 0
		 	</if>
		 	<if test="idx != null and !idx.equalsIgnoreCase('')">
		 		AND
		 			IDX = ${idx}
			</if>
		 
		 	<choose>
		 		<when test="(pageNum != null and pageNum == 1) or(type != null and type.equalsIgnoreCase('latest'))">
					ORDER BY UDATE DESC LIMIT ${contentNum}
				</when>
				<when test="type != null and (!type.equalsIgnoreCase('marker') and !type.equalsIgnoreCase('one'))">
					ORDER BY UDATE DESC LIMIT ${contentNum} OFFSET ${offset}
				</when>
		 	</choose>
    </select>
    
    <select id="selectImageListLen" parameterType="paramMap" resultType="resultMap">
    	SELECT 
			COUNT(*) TOTAL_CNT
		FROM 
			TEST_IMAGE_CONTENT
		WHERE
			1 = 1
		AND
	    	(
	    		ID = '${loginId}'
	    	<if test="myContent == null || (myContent != null and !myContent.equalsIgnoreCase('Y'))">
	    	OR 
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			(
						'${loginId}' IN
						(
		    				SELECT 
		    					ID 
		    				FROM 
		    					TEST_GEOCMS_SHARE 
		    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
		    				WHERE 
		    					SHAREKIND IN('GeoPhoto') 
		    				AND  
		    					SHAREIDX = TEST_IMAGE_CONTENT.IDX
						)
					OR
						'${loginId}' IN
						(SELECT ID FROM TEST_PROJECT_CONTENT WHERE IDX = TEST_IMAGE_CONTENT.PROJECTIDX)
	    			)
	    		)
	    	 </if>
	    	)	
	    	
			<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All')">
				AND
					TABNAME = '${tabName}'
			</if>
    </select>
    
    <insert id="insertImage" parameterType="paramMap" useGeneratedKeys="true" keyProperty="idx">
        INSERT INTO TEST_IMAGE_CONTENT
        (
        	 ID
        	,TITLE
        	,CONTENT
        	,FILENAME
        	,FILEPATH
        	,LONGITUDE
        	,LATITUDE
        	,RDATE
        	,UDATE
        	,TABNAME
        	,SHARETYPE
        	,PROJECTIDX
        )
        VALUES
        (
        	 '${loginId}'
        	,'${title}'
        	,'${content}'
        	,'${filesStr}'
        	,'${filePath}'
        	, ${longitude}
        	, ${latitude}
        	, NOW()
        	, NOW()
        	,'${tabName}'
        	, ${shareType}
        	, ${projectIdx}
        )
        <selectKey keyProperty="idx" resultType="int" order="AFTER">
        	SELECT LAST_INSERT_ID()
   		</selectKey>
    </insert>
    
    <update id="updateImage" parameterType="paramMap">
    	UPDATE
    		TEST_IMAGE_CONTENT
    	SET
    		 TITLE			= '${title}'
    		,CONTENT		= '${content}'
    		,TABNAME		= '${tabName}'
    		,UDATE			=  NOW()
    		,SHARETYPE		=  ${shareType}
    		,XMLDATA		= '${xmlData}'
    		,LONGITUDE		= '${longitude}'
    		,LATITUDE		= '${latitude}'
    	WHERE 
    		1 = 1
    	AND
    		IDX = ${idx}
    </update>
    
    <delete id="deleteImage">
    	DELETE
    		FROM
    			TEST_IMAGE_CONTENT
    		WHERE
    			IDX = ${idx}
    		AND
    			ID = '${loginId}'
    </delete>
    
    <update id="updateXmlData" parameterType="paramMap">
    	UPDATE
    		TEST_IMAGE_CONTENT
    	SET
    		 XMLDATA		= '${xmlData}'
    	WHERE 
    		1 = 1
    	AND
    		IDX = ${idx}
    </update>
    
    <update id="updateImageMove" parameterType="paramMap">
    	UPDATE
    		TEST_IMAGE_CONTENT
    	SET
    		 UDATE			=  NOW()
    		,SHARETYPE		=  ${shareType}
    		<if test="projectIdx != null">
    			,PROJECTIDX		=  ${projectIdx}
    		</if>
    	WHERE 
    		1 = 1
    	AND
    		IDX = ${moveContent}
    </update>
    
    <select id="selectVideoList" parameterType="paramMap" resultType="resultMap">
		SELECT 
			 ID
			,TITLE
			,CONTENT
			,FILENAME
			,FILEPATH
			,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
			,UDATE
			,IDX
			,TABNAME
			,LATITUDE
			,LONGITUDE
			,THUMBNAIL
			,ORIGINNAME
			,'GeoVideo' AS DATAKIND
			,SHARETYPE
		FROM 
			TEST_VIDEO_CONTENT
		WHERE
			1 = 1
		AND
	    	(	
	    		ID = '${loginId}'
	    	<if test="myContent == null || (myContent != null and !myContent.equalsIgnoreCase('Y'))">
	    	OR
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			'${loginId}' IN 
	    			(
	    				SELECT 
	    					ID 
	    				FROM 
	    					TEST_GEOCMS_SHARE 
	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
	    				WHERE 
	    					SHAREKIND = 'GeoVideo' 
	    				AND
	    					SHAREIDX = TEST_VIDEO_CONTENT.IDX
	    			)
	    		)
	    	 </if>
	    	)
	    	
			<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All') and type != null and !type.equalsIgnoreCase('latest')">
				AND
					TABNAME = '${tabName}'
			</if>
			<if test="type != null and type.equalsIgnoreCase('marker')">
				AND 
		 			LATITUDE IS NOT NULL 
		 		AND  
		 			LONGITUDE IS NOT NULL
		 		AND 
		 			LATITUDE != 0
		 		AND 
		 			LONGITUDE != 0
		 	</if>
		 	<if test="idx != null and !idx.equalsIgnoreCase('')">
		 		AND
		 			IDX = ${idx}
			</if>
		 
		 	<choose>
		 		<when test="(pageNum != null and pageNum == 1) or(type != null and type.equalsIgnoreCase('latest'))">
					ORDER BY UDATE DESC LIMIT ${contentNum}
				</when>
				<when test="type != null and (!type.equalsIgnoreCase('marker') and !type.equalsIgnoreCase('one'))">
					ORDER BY UDATE DESC LIMIT ${contentNum} OFFSET ${offset}
				</when>
		 	</choose>
    </select>
    
    <select id="selectVideoListLen" parameterType="paramMap" resultType="resultMap">
    	SELECT 
			COUNT(*) TOTAL_CNT
		FROM 
			TEST_VIDEO_CONTENT
		WHERE
			1 = 1
		AND
	    	(
	    		ID = '${loginId}'
	    	<if test="myContent == null || (myContent != null and !myContent.equalsIgnoreCase('Y'))">
	    	OR 
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			'${loginId}' IN
	    			(
	    				SELECT 
	    					ID 
	    				FROM 
	    					TEST_GEOCMS_SHARE 
	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
	    				WHERE 
	    					SHAREKIND = 'GeoVideo' 
	    				AND  
	    					SHAREIDX = TEST_VIDEO_CONTENT.IDX
	    			)
	    		)
	    	 </if>
	    	)	
	    	
			<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All')">
				AND
					TABNAME = '${tabName}'
			</if>
    </select>
    
    <insert id="insertVideo" parameterType="paramMap" useGeneratedKeys="true" keyProperty="idx">
        INSERT INTO TEST_VIDEO_CONTENT
        (
        	 ID
        	,TITLE
        	,CONTENT
        	,ORIGINNAME
        	,FILENAME
        	,THUMBNAIL
        	,FILEPATH
        	,LONGITUDE
        	,LATITUDE
        	,RDATE
        	,UDATE
        	,TABNAME
        	,SHARETYPE
        )
        VALUES
        (
        	 '${loginId}'
        	,'${title}'
        	,'${content}'
        	,'${originname}'
        	,'${filename}'
        	,'${thumbnail}'
        	,'${filePath}'
        	, ${longitude}
        	, ${latitude}
        	, NOW()
        	, NOW()
        	,'${tabName}'
        	, ${shareType}
        )
        <selectKey keyProperty="idx" resultType="int" order="AFTER">
        	SELECT LAST_INSERT_ID()
   		</selectKey>
    </insert>
    
    <update id="updateVideo" parameterType="paramMap">
    	UPDATE
    		TEST_VIDEO_CONTENT
    	SET
    		 TITLE			= '${title}'
    		,CONTENT		= '${content}'
    		,TABNAME		= '${tabName}'
    		,UDATE			=  NOW()
    		,SHARETYPE		=  ${shareType}
    		,XMLDATA		= '${xmlData}'
    	WHERE 
    		1 = 1
    	AND
    		IDX = ${idx}
    </update>
    
    <select id="selectProjectList" parameterType="paramMap" resultType="resultMap">
    	SELECT
    		*
    	FROM
    		(
			SELECT 
				 TEST_PROJECT_CONTENT.ID
		       	,TEST_PROJECT_CONTENT.PROJECTNAME
		       	,TEST_PROJECT_CONTENT.IDX
		       	,DATE_FORMAT(TEST_PROJECT_CONTENT.UDATE,'%Y-%m-%d') U_DATE
		       	,TEST_PROJECT_CONTENT.UDATE
		       	,TEST_PROJECT_CONTENT.RDATE
		       	,TEST_PROJECT_CONTENT.SHARETYPE
		       	,TEST_PROJECT_CONTENT.MARKERICON
		       	,CASE
				 	WHEN TEST_PROJECT_CONTENT.UDATE > IFNULL(TEST_IMAGE_CONTENT.UDATE,0)
				 	THEN TEST_PROJECT_CONTENT.UDATE
				 	ELSE TEST_IMAGE_CONTENT.UDATE
				 END IMG_UDATE
				,CASE
					WHEN '${loginId}' IN (SELECT 
			    					  	ID 
			    					  FROM 
			    					  	TEST_GEOCMS_SHARE 
			    					  LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
			    				      WHERE 
			    					  	SHAREKIND = 'GeoProject' 
			    				      AND
			    					  	SHAREIDX = TEST_PROJECT_CONTENT.IDX
			    				      AND
			    						SHAREEDIT = 'Y') 
			    	THEN 'Y'
			    	ELSE 'N'
			    END AS editUserIn
			FROM 
				TEST_PROJECT_CONTENT
			LEFT JOIN TEST_IMAGE_CONTENT ON TEST_IMAGE_CONTENT.PROJECTIDX = TEST_PROJECT_CONTENT.IDX
			WHERE
					1 = 1
				AND
			    	(	
			    		TEST_PROJECT_CONTENT.ID = '${loginId}'
			    	OR 
			    		(
			    			TEST_PROJECT_CONTENT.SHARETYPE = 2
			    		AND 
			    			'${loginId}' IN 
			    			(
			    				SELECT 
			    					ID 
			    				FROM 
			    					TEST_GEOCMS_SHARE 
			    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
			    				WHERE 
			    					SHAREKIND = 'GeoProject' 
			    				AND
			    					SHAREIDX = TEST_PROJECT_CONTENT.IDX
			    				<if test="shareEdit != null and shareEdit.equalsIgnoreCase('Y')">
			    					AND SHAREEDIT = 'Y'
			    				</if>
			    			)
			    		)
			    	)
			    <if test="projectIdx != null">
			    	AND TEST_PROJECT_CONTENT.IDX = ${projectIdx}
			    </if>
			 ORDER BY IMG_UDATE DESC
			)PROJECTGROUP
		GROUP BY PROJECTGROUP.IDX
		ORDER BY 
			<if test="orderIdx != null and !orderIdx.equalsIgnoreCase('')">
			    PROJECTGROUP.IDX = ${orderIdx} DESC,
			</if>
			PROJECTGROUP.IMG_UDATE DESC
    </select>
    
   <select id="selectProjectContentList" parameterType="paramMap" resultType="resultMap">
    	SELECT 
    		*
    		,TEST_PROJECT_CONTENT.PROJECTNAME 					PROJECTNAME
    		,DATE_FORMAT(TEST_PROJECT_CONTENT.UDATE,'%Y-%m-%d')	PROJECTUDATE
    		,TEST_PROJECT_CONTENT.SHARETYPE						PROJECTSHARE
    		,TEST_PROJECT_CONTENT.MARKERICON					PROJECTMARKERICON
    	FROM(
		    SELECT
		    	 ID
		    	,TITLE
		    	,CONTENT
		    	,FILENAME
		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
		    	,UDATE
		    	,IDX
		    	,TABNAME
		    	,LATITUDE
		    	,LONGITUDE
		    	,NULL AS THUMBNAIL
		    	,NULL AS ORIGINNAME
		    	,PROJECTIDX
		    	,'GeoPhoto' AS DATAKIND
		    	,SHARETYPE
		    	,(SELECT id FROM test_project_content WHERE test_project_content.idx = TEST_IMAGE_CONTENT.projectIdx) projectUserId
		    FROM
		    	TEST_IMAGE_CONTENT
	  		UNION
		    SELECT
		    	 ID
		    	,TITLE
		    	,CONTENT
		    	,FILENAME
		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
		    	,UDATE
		    	,IDX
		    	,TABNAME
		    	,LATITUDE
		    	,LONGITUDE
		    	,THUMBNAIL
		    	,ORIGINNAME
		    	,PROJECTIDX
		    	,'GeoVideo' AS DATAKIND
		    	,SHARETYPE
		    	,(SELECT id FROM test_project_content WHERE test_project_content.idx = TEST_VIDEO_CONTENT.projectIdx) projectUserId
		    FROM
		    	TEST_VIDEO_CONTENT
	    ) CONTENT_TABLE
	    LEFT JOIN TEST_PROJECT_CONTENT ON TEST_PROJECT_CONTENT.IDX = CONTENT_TABLE.PROJECTIDX 
	    WHERE
	    	1 = 1
	    <if test="projectIdx != null">
	    	AND 
	    		TEST_PROJECT_CONTENT.IDX = ${projectIdx}
	    </if>
	    <if test="type != null and type.equalsIgnoreCase('marker')">
			AND 
				CONTENT_TABLE.LATITUDE IS NOT NULL 
			AND  
				CONTENT_TABLE.LONGITUDE IS NOT NULL
			AND 
				CONTENT_TABLE.LATITUDE != 0
			AND 
				CONTENT_TABLE.LONGITUDE != 0
		</if>
	    
	    <if test="getProject != null and getProject.equalsIgnoreCase('Y')">
	    AND
	    	(
	    		CONTENT_TABLE.ID = '${loginId}'
	    	OR 
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		CONTENT_TABLE.SHARETYPE = 1
	    	OR 
	    		(
	    			CONTENT_TABLE.SHARETYPE = 2
	    		AND 
	    			(
						'${loginId}' IN
						(
		    				SELECT 
		    					ID 
		    				FROM 
		    					TEST_GEOCMS_SHARE 
		    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
		    				WHERE 
		    					SHAREKIND IN('GeoPhoto', 'GeoVideo') 
		    				AND  
		    					SHAREIDX = CONTENT_TABLE.IDX
						)
					OR
						'${loginId}' IN
						(SELECT ID FROM TEST_PROJECT_CONTENT WHERE IDX = CONTENT_TABLE.PROJECTIDX)
	    			)
	    		)
	    	)
	    </if>
	    <choose>
			<when test="pageNum != null and pageNum == 1">
				ORDER BY TEST_PROJECT_CONTENT.UDATE DESC, TEST_PROJECT_CONTENT.IDX DESC LIMIT ${contentNum}
			</when>
			<when test="pageNum != null and contentNum != null and offset != null">
				ORDER BY TEST_PROJECT_CONTENT.UDATE DESC, TEST_PROJECT_CONTENT.IDX DESC LIMIT ${contentNum} OFFSET ${offset}
			</when>
		</choose>
    </select>
    
    <select id="selectProjectContentListLen" parameterType="paramMap" resultType="resultMap">
    	SELECT 
    		COUNT(*) TOTAL_CNT
    	FROM(
		    SELECT
		    	 ID
		    	,TITLE
		    	,CONTENT
		    	,FILENAME
		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
		    	,IDX
		    	,TABNAME
		    	,LATITUDE
		    	,LONGITUDE
		    	,NULL AS THUMBNAIL
		    	,NULL AS ORIGINNAME
		    	,PROJECTIDX
		    	,'GeoPhoto' AS DATAKIND
		    	,SHARETYPE
		    FROM
		    	TEST_IMAGE_CONTENT
	  		UNION
		    SELECT
		    	 ID
		    	,TITLE
		    	,CONTENT
		    	,FILENAME
		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
		    	,IDX
		    	,TABNAME
		    	,LATITUDE
		    	,LONGITUDE
		    	,THUMBNAIL
		    	,ORIGINNAME
		    	,PROJECTIDX
		    	,'GeoVideo' AS DATAKIND
		    	,SHARETYPE
		    FROM
		    	TEST_VIDEO_CONTENT
	    ) CONTENT_TABLE
	    LEFT JOIN TEST_PROJECT_CONTENT ON TEST_PROJECT_CONTENT.IDX = CONTENT_TABLE.PROJECTIDX 
	    WHERE
	    	1 = 1
	    <if test="projectIdx != null">
	    	AND TEST_PROJECT_CONTENT.IDX = ${projectIdx}
	    </if>
	    <if test="getProject != null and getProject.equalsIgnoreCase('Y')">
	    AND
	    	(
	    		CONTENT_TABLE.ID = '${loginId}'
	    	OR 
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		CONTENT_TABLE.SHARETYPE = 1
	    	OR 
	    		(
	    			CONTENT_TABLE.SHARETYPE = 2
	    		AND 
	    			(
						'${loginId}' IN
						(
		    				SELECT 
		    					ID 
		    				FROM 
		    					TEST_GEOCMS_SHARE 
		    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
		    				WHERE 
		    					SHAREKIND IN('GeoPhoto', 'GeoVideo') 
		    				AND  
		    					SHAREIDX = CONTENT_TABLE.IDX
						)
					OR
						'${loginId}' IN
						(SELECT ID FROM TEST_PROJECT_CONTENT WHERE IDX = CONTENT_TABLE.PROJECTIDX)
	    			)
	    		)
	    	)
	    </if>
    </select>
    
    <insert id="insertProject" parameterType="paramMap" useGeneratedKeys="true" keyProperty="idx">
        INSERT INTO TEST_PROJECT_CONTENT
        (
        	 ID
        	,PROJECTNAME
        	,RDATE
        	,UDATE
        	,SHARETYPE
        	,MARKERICON
        )
        VALUES
        (
        	 '${loginId}'
        	,'${projectName}'
        	, NOW()
        	, NOW()
        	, ${shareType}
        	,'${markerIcon}'
        )
        <selectKey keyProperty="idx" resultType="int" order="AFTER">
        	SELECT LAST_INSERT_ID()
   		</selectKey>
    </insert>
    
    <update id="updateProject" parameterType="paramMap">
    	UPDATE
    		TEST_PROJECT_CONTENT
    	SET
    		 PROJECTNAME	= '${projectName}'
    		,UDATE			=  NOW()
    		,SHARETYPE		=  ${shareType}
    		,MARKERICON		= '${markerIcon}'
    	WHERE 
    		1 = 1
    	AND
    		IDX = ${idx}
    </update>
    
    <delete id="deleteProject">
    	DELETE
    		FROM
    			TEST_PROJECT_CONTENT
    		WHERE
    			IDX = ${projectIdx}
    		AND
    			ID = '${loginId}'
    </delete>

<!--     <select id="selectProjectList" parameterType="paramMap" resultType="resultMap"> -->
<!-- 	    SELECT  -->
<!-- 			 ID -->
<!--         	,PROJECTNAME -->
<!--         	,IDX -->
<!--         	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!--         	,SHARETYPE -->
<!-- 		FROM  -->
<!-- 			TEST_PROJECT_CONTENT -->
<!-- 		WHERE -->
<!-- 	    	1 = 1 -->
<!-- 	    AND -->
<!-- 	    	( -->
<!-- 	    		ID = '${loginId}'  -->
<!-- 	    	OR  -->
<!-- 	    		SHARETYPE = 1 -->
<!-- 	    	OR  -->
<!-- 	    		( -->
<!-- 	    			SHARETYPE = 2 AND '${loginId}' =  -->
<!-- 	    			( -->
<!-- 	    				SELECT  -->
<!-- 	    					ID  -->
<!-- 	    				FROM  -->
<!-- 	    					TEST_GEOCMS_SHARE  -->
<!-- 	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID -->
<!-- 	    				WHERE  -->
<!-- 	    					SHAREKIND = 'GeoProject'  -->
<!-- 	    				AND  -->
<!-- 	    					SHAREIDX = TEST_PROJECT_CONTENT.IDX -->
<!-- 	    			) -->
<!-- 	    		) -->
<!-- 	    	) -->
<!--     </select> -->
    
<!--     <select id="selectProjectListLen" parameterType="paramMap" resultType="resultMap"> -->
<!-- 	    SELECT  -->
<!-- 			COUNT(*) TOTAL_CNT -->
<!-- 		FROM  -->
<!-- 			TEST_PROJECT_CONTENT -->
<!-- 		WHERE -->
<!-- 	    	1 = 1 -->
<!-- 	    AND -->
<!-- 	    	( -->
<!-- 	    		ID = '${loginId}'  -->
<!-- 	    	OR  -->
<!-- 	    		SHARETYPE = 1 -->
<!-- 	    	OR  -->
<!-- 	    		( -->
<!-- 	    			SHARETYPE = 2 AND '${loginId}' =  -->
<!-- 	    			( -->
<!-- 	    				SELECT  -->
<!-- 	    					ID  -->
<!-- 	    				FROM  -->
<!-- 	    					TEST_GEOCMS_SHARE  -->
<!-- 	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID -->
<!-- 	    				WHERE  -->
<!-- 	    					SHAREKIND = 'GeoProject'  -->
<!-- 	    				AND  -->
<!-- 	    					SHAREIDX = TEST_PROJECT_CONTENT.IDX -->
<!-- 	    			) -->
<!-- 	    		) -->
<!-- 	    	) -->
<!--     </select> -->
    
<!--     <insert id="insertProject" parameterType="paramMap" useGeneratedKeys="true" keyProperty="idx"> -->
<!--         INSERT INTO TEST_PROJECT_CONTENT -->
<!--         ( -->
<!--         	 ID -->
<!--         	,PROJECTNAME -->
<!--         	,UDATE -->
<!--         	,SHARE -->
<!--         ) -->
<!--         VALUES -->
<!--         ( -->
<!--         	 '${loginId}' -->
<!--         	,'${projectName}' -->
<!--         	, NOW() -->
<!--         	,'${share}' -->
<!--         ) -->
<!--         <selectKey keyProperty="idx" resultType="int" order="AFTER"> -->
<!--         	SELECT LAST_INSERT_ID() -->
<!--    		</selectKey> -->
<!--     </insert> -->
    
<!--     <select id="selectProjectContentList" parameterType="paramMap" resultType="resultMap"> -->
<!--     	SELECT  -->
<!--     		* -->
<!--     		,TEST_PROJECT_CONTENT.PROJECTNAME 					PROJECTNAME -->
<!--     		,TEST_PROJECT_CONTENT.SHARE							PROJECTSHARE -->
<!--     		,DATE_FORMAT(TEST_PROJECT_CONTENT.UDATE,'%Y-%m-%d')	PROJECTUDATE -->
<!--     	FROM( -->
<!--    		<if test="projectType != null and (projectType.equalsIgnoreCase('image') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,NULL AS THUMBNAIL -->
<!-- 		    	,NULL AS ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoPhoto' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_IMAGE_CONTENT -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and projectType.equalsIgnoreCase('both')"> -->
<!-- 	  		UNION -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and (projectType.equalsIgnoreCase('video') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,THUMBNAIL -->
<!-- 		    	,ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoVideo' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_VIDEO_CONTENT -->
<!-- 	    </if> -->
<!-- 	    ) CONTENT_TABLE -->
<!-- 	    LEFT JOIN TEST_PROJECT_CONTENT ON TEST_PROJECT_CONTENT.IDX = CONTENT_TABLE.PROJECTIDX  -->
<!-- 	    WHERE -->
<!-- 	    	1 = 1 -->
<!-- 	    AND -->
<!-- 	    	( -->
<!-- 	    		TEST_PROJECT_CONTENT.ID = '${loginId}'  -->
<!-- 	    	OR  -->
<!-- 	    		TEST_PROJECT_CONTENT.SHARE = 1 -->
<!-- 	    	OR  -->
<!-- 	    		( -->
<!-- 	    			TEST_PROJECT_CONTENT.SHARE = 2 AND '${loginId}' =  -->
<!-- 	    			( -->
<!-- 	    				SELECT  -->
<!-- 	    					ID  -->
<!-- 	    				FROM  -->
<!-- 	    					TEST_GEOCMS_SHARE  -->
<!-- 	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID -->
<!-- 	    				WHERE  -->
<!-- 	    					SHAREKIND = 'GeoProject'  -->
<!-- 	    				AND  -->
<!-- 	    					SHAREIDX = TEST_PROJECT_CONTENT.IDX -->
<!-- 	    			) -->
<!-- 	    		) -->
<!-- 	    	) -->
	    	
<!-- 	    <if test="projectIdx != null"> -->
<!-- 	    	AND TEST_PROJECT_CONTENT.IDX = ${projectIdx} -->
<!-- 	    </if> -->
<!-- 	    <choose> -->
<!-- 			<when test="pageNum != null and pageNum == 1"> -->
<!-- 				ORDER BY TEST_PROJECT_CONTENT.IDX, TEST_PROJECT_CONTENT.UDATE DESC LIMIT ${contentNum} -->
<!-- 			</when> -->
<!-- 			<otherwise> -->
<!-- 				ORDER BY TEST_PROJECT_CONTENT.IDX, TEST_PROJECT_CONTENT.UDATE DESC LIMIT ${contentNum} OFFSET ${offset} -->
<!-- 			</otherwise> -->
<!-- 		</choose> -->
<!--     </select> -->
    
<!--     <select id="selectProjectContentListLen" parameterType="paramMap" resultType="resultMap"> -->
<!--     	SELECT  -->
<!--     		COUNT(*) TOTAL_CNT -->
<!--     	FROM( -->
<!--    		<if test="projectType != null and (projectType.equalsIgnoreCase('image') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,NULL AS THUMBNAIL -->
<!-- 		    	,NULL AS ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoPhoto' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_IMAGE_CONTENT -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and projectType.equalsIgnoreCase('both')"> -->
<!-- 	  		UNION -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and (projectType.equalsIgnoreCase('video') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,THUMBNAIL -->
<!-- 		    	,ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoVideo' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_VIDEO_CONTENT -->
<!-- 	    </if> -->
<!-- 	    ) CONTENT_TABLE -->
<!-- 	    LEFT JOIN TEST_PROJECT_CONTENT ON TEST_PROJECT_CONTENT.IDX = CONTENT_TABLE.PROJECTIDX  -->
<!-- 	    WHERE -->
<!-- 	    	1 = 1 -->
<!-- 	    AND -->
<!-- 	    	( -->
<!-- 	    		TEST_PROJECT_CONTENT.ID = '${loginId}'  -->
<!-- 	    	OR  -->
<!-- 	    		TEST_PROJECT_CONTENT.SHARE = 1 -->
<!-- 	    	OR  -->
<!-- 	    		( -->
<!-- 	    			TEST_PROJECT_CONTENT.SHARE = 2 AND '${loginId}' =  -->
<!-- 	    			( -->
<!-- 	    				SELECT  -->
<!-- 	    					ID  -->
<!-- 	    				FROM  -->
<!-- 	    					TEST_GEOCMS_SHARE  -->
<!-- 	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID -->
<!-- 	    				WHERE  -->
<!-- 	    					SHAREKIND = 'GeoProject'  -->
<!-- 	    				AND  -->
<!-- 	    					SHAREIDX = TEST_PROJECT_CONTENT.IDX -->
<!-- 	    			) -->
<!-- 	    		) -->
<!-- 	    	) -->
	    	
<!-- 	    <if test="projectIdx != null"> -->
<!-- 	    	AND TEST_PROJECT_CONTENT.IDX = ${projectIdx} -->
<!-- 	    </if> -->
<!--     </select> -->
    
<!--     <select id="selectProjectContentList" parameterType="paramMap" resultType="resultMap"> -->
<!--     	SELECT  -->
<!--     		* -->
<!--     		,TEST_PROJECT_CONTENT.PROJECTNAME 					PROJECTNAME -->
<!--     		,TEST_PROJECT_CONTENT.SHARE							PROJECTSHARE -->
<!--     		,DATE_FORMAT(TEST_PROJECT_CONTENT.UDATE,'%Y-%m-%d')	PROJECTUDATE -->
<!--     	FROM( -->
<!--    		<if test="projectType != null and (projectType.equalsIgnoreCase('image') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,NULL AS THUMBNAIL -->
<!-- 		    	,NULL AS ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoPhoto' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_IMAGE_CONTENT -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and projectType.equalsIgnoreCase('both')"> -->
<!-- 	  		UNION -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and (projectType.equalsIgnoreCase('video') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,THUMBNAIL -->
<!-- 		    	,ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoVideo' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_VIDEO_CONTENT -->
<!-- 	    </if> -->
<!-- 	    ) CONTENT_TABLE -->
<!-- 	    LEFT JOIN TEST_PROJECT_CONTENT ON TEST_PROJECT_CONTENT.IDX = CONTENT_TABLE.PROJECTIDX  -->
<!-- 	    WHERE -->
<!-- 	    	1 = 1 -->
<!-- 	    AND -->
<!-- 	    	( -->
<!-- 	    		TEST_PROJECT_CONTENT.ID = '${loginId}'  -->
<!-- 	    	OR  -->
<!-- 	    		TEST_PROJECT_CONTENT.SHARE = 1 -->
<!-- 	    	OR  -->
<!-- 	    		( -->
<!-- 	    			TEST_PROJECT_CONTENT.SHARE = 2 AND '${loginId}' =  -->
<!-- 	    			( -->
<!-- 	    				SELECT  -->
<!-- 	    					ID  -->
<!-- 	    				FROM  -->
<!-- 	    					TEST_GEOCMS_SHARE  -->
<!-- 	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID -->
<!-- 	    				WHERE  -->
<!-- 	    					SHAREKIND = 'GeoProject'  -->
<!-- 	    				AND  -->
<!-- 	    					SHAREIDX = TEST_PROJECT_CONTENT.IDX -->
<!-- 	    			) -->
<!-- 	    		) -->
<!-- 	    	) -->
	    	
<!-- 	    <if test="projectIdx != null"> -->
<!-- 	    	AND TEST_PROJECT_CONTENT.IDX = ${projectIdx} -->
<!-- 	    </if> -->
<!-- 	    <if test="projectGroup != null and projectGroup.equalsIgnoreCase('Y')"> -->
<!-- 	   		GROUP BY -->
<!-- 	    		TEST_PROJECT_CONTENT.IDX -->
<!-- 	    </if> -->
<!-- 	    <choose> -->
<!-- 			<when test="pageNum != null and pageNum == 1"> -->
<!-- 				ORDER BY TEST_PROJECT_CONTENT.IDX, TEST_PROJECT_CONTENT.UDATE DESC LIMIT ${contentNum} -->
<!-- 			</when> -->
<!-- 			<when test="projectGroup != null and projectGroup.equalsIgnoreCase('Y')"> -->
<!-- 				ORDER BY TEST_PROJECT_CONTENT.IDX, TEST_PROJECT_CONTENT.UDATE DESC -->
<!-- 			</when> -->
<!-- 			<otherwise> -->
<!-- 				ORDER BY TEST_PROJECT_CONTENT.IDX, TEST_PROJECT_CONTENT.UDATE DESC LIMIT ${contentNum} OFFSET ${offset} -->
<!-- 			</otherwise> -->
<!-- 		</choose> -->
<!--     </select> -->
    
<!--     <select id="selectProjectContentListLen" parameterType="paramMap" resultType="resultMap"> -->
<!--     	SELECT  -->
<!--     		COUNT(*) TOTAL_CNT -->
<!--     	FROM( -->
<!--    		<if test="projectType != null and (projectType.equalsIgnoreCase('image') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,NULL AS THUMBNAIL -->
<!-- 		    	,NULL AS ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoPhoto' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_IMAGE_CONTENT -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and projectType.equalsIgnoreCase('both')"> -->
<!-- 	  		UNION -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and (projectType.equalsIgnoreCase('video') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,THUMBNAIL -->
<!-- 		    	,ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoVideo' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_VIDEO_CONTENT -->
<!-- 	    </if> -->
<!-- 	    ) CONTENT_TABLE -->
<!-- 	    LEFT JOIN TEST_PROJECT_CONTENT ON TEST_PROJECT_CONTENT.IDX = CONTENT_TABLE.PROJECTIDX  -->
<!-- 	    WHERE -->
<!-- 	    	1 = 1 -->
<!-- 	    AND -->
<!-- 	    	( -->
<!-- 	    		TEST_PROJECT_CONTENT.ID = '${loginId}'  -->
<!-- 	    	OR  -->
<!-- 	    		TEST_PROJECT_CONTENT.SHARE = 1 -->
<!-- 	    	OR  -->
<!-- 	    		( -->
<!-- 	    			TEST_PROJECT_CONTENT.SHARE = 2  -->
<!-- 	    		AND  -->
<!-- 	    			'${loginId}' =  -->
<!-- 	    			( -->
<!-- 	    				SELECT  -->
<!-- 	    					ID  -->
<!-- 	    				FROM  -->
<!-- 	    					TEST_GEOCMS_SHARE  -->
<!-- 	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID -->
<!-- 	    				WHERE  -->
<!-- 	    					SHAREKIND = 'GeoProject'  -->
<!-- 	    				AND   -->
<!-- 	    					SHAREIDX = TEST_PROJECT_CONTENT.IDX -->
<!-- 	    			) -->
<!-- 	    		) -->
<!-- 	    	) -->
	    	
<!-- 	    <if test="projectIdx != null"> -->
<!-- 	    	AND TEST_PROJECT_CONTENT.IDX = ${projectIdx} -->
<!-- 	    </if> -->
<!--     </select> -->
    
</mapper>