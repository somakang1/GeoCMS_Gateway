<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="data_old">
     <select id="selectBase" parameterType="paramMap" resultType="resultMap">
        SELECT 
        	* 
        FROM 
        	TEST_GEOCMS_SETTING 
    </select>
    
    <update id="updateBase" parameterType="paramMap">
    	UPDATE
    		TEST_GEOCMS_SETTING
    	SET
    		 CONTENTTAB 		= '${contentTab}'
    		,CONTENTTABTYPE 	= '${contentTabType}'
    		,BOARDTAB 			= '${boardTab}'
    		,CONTENTNUM 		= '${contentNum}'
    		,BOARDNUM 			= '${boardNum}'
    		,OPENAPI			= '${openAPI}'
    		,LATESTVIEW			= '${latestView}'
    		,MAPZOOM 			= '${mapZoom}'
    </update>
    
    <update id="updateTabNameBoard" parameterType="paramMap">
    	UPDATE
    		TEST_BOARD_CONTENT
    	SET
    		TABNAME 		= '${newTabName}'
    	WHERE
    		TABNAME			= '${oldTabName}'
    </update>
    
    <update id="updateTabNameImage" parameterType="paramMap">
    	UPDATE
    		TEST_IMAGE_CONTENT
    	SET
    		TABNAME 		= '${newTabName}'
    	WHERE
    		TABNAME			= '${oldTabName}'
    </update>
    
    <update id="updateTabNameVideo" parameterType="paramMap">
    	UPDATE
    		TEST_VIDEO_CONTENT
    	SET
    		TABNAME 		= '${newTabName}'
    	WHERE
    		TABNAME			= '${oldTabName}'
    </update>
    
    <select id="selectBoardList" parameterType="paramMap" resultType="resultMap">
	    SELECT 
			 ID
        	,TITLE
        	,CONTENT
        	,FILENAME
        	,FILEPATH
        	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
        	,IDX
        	,TABNAME
        	,NULL AS LATITUDE
		   	,NULL AS LONGITUDE
		    ,NULL AS THUMBNAIL
		    ,NULL AS ORIGINNAME
		    ,'GeoCMS' AS DATAKIND
        	,SHARETYPE
		FROM 
			TEST_BOARD_CONTENT
		WHERE
			1 = 1
		AND
	    	(
	    		ID = '${loginId}'
	    	<if test="myContent == null || (myContent != null and !myContent.equalsIgnoreCase('Y'))">
	    	OR 
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			'${loginId}' = 
	    			(
	    				SELECT 
	    					ID 
	    				FROM 
	    					TEST_GEOCMS_SHARE 
	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
	    				WHERE 
	    					SHAREKIND = 'GeoCMS' 
	    				AND
	    					SHAREIDX = IDX
	    			)
	    		)
	    	 </if>
	    	)
	    	
			<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All') and type != null and !type.equalsIgnoreCase('latest')">
				AND
					TABNAME = '${tabName}'
			</if>	
			<if test="idx != null">
		 		AND
		 			IDX = ${idx}
			</if>
		 
		 	<choose>
				<when test="pageNum != null and pageNum.equalsIgnoreCase('1')">
					ORDER BY uDate DESC LIMIT ${contentNum}
				</when>
				<when test="orderIdx != null">
					ORDER BY idx DESC LIMIT ${orderIdx}
				</when>
				<when test="pageNum != null and !pageNum.equalsIgnoreCase('1')">
					ORDER BY uDate DESC LIMIT ${contentNum} OFFSET ${offset}
				</when>
				<when test="contentNum != null">
					ORDER BY idx DESC LIMIT ${contentNum}
				</when>
			</choose>
    </select>
    
    <select id="selectBoardListLen" parameterType="paramMap" resultType="resultMap">
	    SELECT 
			COUNT(*) TOTAL_CNT
		FROM 
			TEST_BOARD_CONTENT
		WHERE
			1 = 1
		AND
	    	(
	    		ID = '${loginId}'
	    	<if test="myContent == null || (myContent != null and !myContent.equalsIgnoreCase('Y'))">
	    	OR 
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			'${loginId}' = 
	    			(
	    				SELECT 
	    					ID 
	    				FROM 
	    					TEST_GEOCMS_SHARE 
	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
	    				WHERE 
	    					SHAREKIND = 'GeoCMS' 
	    				AND
	    					SHAREIDX = IDX
	    			)
	    		)
	    	 </if>
	    	)
		<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All')">
			AND
				TABNAME = '${tabName}'
		</if>
    </select>
    
    <insert id="insertBoard" parameterType="paramMap" useGeneratedKeys="true" keyProperty="idx">
        INSERT INTO TEST_BOARD_CONTENT
        (
        	 ID
        	,TITLE
        	,CONTENT
        	,FILENAME
        	,FILEPATH
        	,UDATE
        	,TABNAME
        	,SHARETYPE
        )
        VALUES
        (
        	 '${loginId}'
        	,'${title}'
        	,'${content}'
        	,'${files}'
        	,'${filePath}'
        	, NOW()
        	,'${tabName}'
        	, ${shareType}
        )
        <selectKey keyProperty="idx" resultType="int" order="AFTER">
        	SELECT LAST_INSERT_ID()
   		</selectKey>
    </insert>
    
    <update id="updateBoard" parameterType="paramMap">
    	UPDATE
    		TEST_BOARD_CONTENT
    	SET
    		 ID 		= '${loginId}'
    		,TITLE 		= '${title}'
    		,CONTENT 	= '${content}'
    		,FILENAME	= '${files}'
    		,FILEPATH	= '${filePath}'
    		,UDATE 		= NOW()
    		,TABNAME 	= '${tabName}'
    		,SHARETYPE 	=  ${shareType}
    	WHERE 
    		1 = 1
    	AND
    		IDX = ${idx}
    </update>
    
    <delete id="deleteBoard">
    	DELETE
    		FROM
    			TEST_BOARD_CONTENT
    		WHERE
    			IDX = ${idx}
    		AND
    			ID = '${loginId}'
    </delete>
    
    <select id="selectContentList" parameterType="paramMap" resultType="resultMap">
	    SELECT
	    	*
	    FROM
	    	(
	    	<if test="myContent == null || (contentViewType != null and (contentViewType.equalsIgnoreCase('Image') || contentViewType.equalsIgnoreCase('Both')))">
			    SELECT
			    	 ID
			    	,TITLE
			    	,CONTENT
			    	,FILENAME
			    	,FILEPATH
			    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
			    	,IDX
			    	,TABNAME
			    	,LATITUDE
			    	,LONGITUDE
			    	,NULL AS THUMBNAIL
			    	,NULL AS ORIGINNAME
			    	,'GeoPhoto' AS DATAKIND
			    	,SHARETYPE
			    FROM
			    	TEST_IMAGE_CONTENT
			 </if>
			 <if test="myContent == null || (contentViewType != null and contentViewType.equalsIgnoreCase('Both'))">
				UNION
			 </if>
			 <if test="myContent == null || (contentViewType != null and (contentViewType.equalsIgnoreCase('Video') || contentViewType.equalsIgnoreCase('Both')))">
			    SELECT
			    	 ID
			    	,TITLE
			    	,CONTENT
			    	,FILENAME
			    	,FILEPATH
			    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
			    	,IDX
			    	,TABNAME
			    	,LATITUDE
			    	,LONGITUDE
			    	,THUMBNAIL
			    	,ORIGINNAME
			    	,'GeoVideo' AS DATAKIND
			    	,SHARETYPE
			    FROM
			    	TEST_VIDEO_CONTENT
			 </if>
			) TEST_CONTENT
			
		    WHERE
		    	1 = 1
		    AND
	    	(
	    		ID = '${loginId}'
	    	<if test="myContent == null || (myContent != null and !myContent.equalsIgnoreCase('Y'))">
	    	OR 
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			'${loginId}' = 
	    			(
	    				SELECT 
	    					ID 
	    				FROM 
	    					TEST_GEOCMS_SHARE 
	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
	    				WHERE
	    					1 = 1
	    				<if test="myContent == null || (contentViewType != null and contentViewType.equalsIgnoreCase('Both'))">
	    					AND	
	    						SHAREKIND IN('GeoPhoto', 'GeoVideo') 
	    				</if>
	    				<if test="contentViewType != null and contentViewType.equalsIgnoreCase('Image')">
	    					AND	
	    						SHAREKIND = 'GeoPhoto'
	    				</if>
	    				<if test="contentViewType != null and contentViewType.equalsIgnoreCase('Video')">
	    					AND	
	    						SHAREKIND = 'GeoVideo'
	    				</if>
	    					
	    				AND
	    					SHAREIDX = IDX
	    			)
	    		)
	    	 </if>
	    	)
	    <if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All')">
			AND
				TABNAME = '${tabName}'
		</if>
    </select>
    
<!--     <select id="selectContentList" parameterType="paramMap" resultType="resultMap"> -->
<!--     SELECT -->
<!--     	* -->
<!--     FROM -->
<!--     	( -->
<!--     		SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,FILEPATH -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') UDATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,NULL AS LATITUDE -->
<!-- 		    	,NULL AS LONGITUDE -->
<!-- 		    	,NULL AS THUMBNAIL -->
<!-- 		    	,NULL AS ORIGINNAME -->
<!-- 		    	,'GeoCMS' AS DATAKIND -->
<!-- 		    	,SHARETYPE -->
<!-- 		    FROM -->
<!-- 		    	TEST_IMAGE_CONTENT -->
<!-- 		<if test="contentViewType == null or (contentViewType != null and !contentViewType.equalsIgnoreCase('board'))"> -->
<!-- 			UNION -->
<!-- 		</if> -->
<!--     	<if test="contentViewType == null or (contentViewType != null and (contentViewType.equalsIgnoreCase('Image') or contentViewType.equalsIgnoreCase('Both')))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,FILEPATH -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,NULL AS THUMBNAIL -->
<!-- 		    	,NULL AS ORIGINNAME -->
<!-- 		    	,'GeoPhoto' AS DATAKIND -->
<!-- 		    	,SHARETYPE -->
<!-- 		    FROM -->
<!-- 		    	TEST_IMAGE_CONTENT -->
<!-- 		 </if> -->
<!-- 		 <if test="contentViewType == null or (contentViewType != null and contentViewType.equalsIgnoreCase('Both'))"> -->
<!-- 			UNION -->
<!-- 		 </if> -->
<!-- 		 <if test="contentViewType == null or (contentViewType != null and (contentViewType.equalsIgnoreCase('Video') or contentViewType.equalsIgnoreCase('Both')))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,FILEPATH -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,THUMBNAIL -->
<!-- 		    	,ORIGINNAME -->
<!-- 		    	,'GeoVideo' AS DATAKIND -->
<!-- 		    	,SHARETYPE -->
<!-- 		    FROM -->
<!-- 		    	TEST_VIDEO_CONTENT -->
<!-- 		 </if> -->
<!-- 		) TEST_CONTENT -->
		
<!-- 	    WHERE -->
<!-- 	    	1 = 1 -->
<!-- 	    AND -->
<!-- 	    	( -->
<!-- 	    		ID = '${loginId}' -->
<!-- 	    	<if test="contentViewType == null">  -->
<!-- 	    	OR  -->
<!-- 	    		SHARETYPE = 1 -->
<!-- 	    	OR  -->
<!-- 				( -->
<!-- 					SHARETYPE = 2  -->
<!-- 				AND  -->
<!-- 					'${loginId}' =  -->
<!-- 					( -->
<!-- 						SELECT  -->
<!-- 							ID  -->
<!-- 						FROM  -->
<!-- 							TEST_GEOCMS_SHARE  -->
<!-- 						LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID -->
<!-- 						WHERE  -->
<!-- 							SHAREKIND = DATAKIND -->
<!-- 						AND  -->
<!-- 							SHAREIDX = IDX -->
<!-- 					) -->
<!-- 				) -->
<!-- 			</if> -->
<!-- 	    	) -->
	    	
<!-- 		   	<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All') and type != null and !type.equalsIgnoreCase('latest')"> -->
<!-- 		    	AND -->
<!-- 		    		TABNAME = '${tabName}' -->
<!-- 		    </if> -->
<!-- 		    <if test="type != null and type.equalsIgnoreCase('marker')">	 -->
<!-- 		    	AND -->
<!-- 		    		LATITUDE IS NOT NULL -->
<!-- 		    	AND -->
<!-- 		    		LONGITUDE IS NOT NULL -->
<!-- 		    	AND -->
<!-- 		    		LATITUDE != 0 -->
<!-- 		    	AND -->
<!-- 		    		LONGITUDE != 0 -->
<!-- 		    </if> -->
	    
<!-- 	      	<choose> -->
<!-- 	       		<when test="pageNum != null and pageNum.equalsIgnoreCase('1')"> -->
<!-- 	       			ORDER BY UDATE DESC LIMIT ${contentNum} -->
<!-- 	       		</when> -->
<!-- 	       		<when test="type != null and type.equalsIgnoreCase('latest')"> -->
<!-- 	       			ORDER BY UDATE DESC, -->
<!--     				IDX DESC LIMIT ${contentNum} -->
<!-- 	       		</when> -->
<!-- 	       		<when test="contentNum != null and offset != null"> -->
<!-- 	       			ORDER BY UDATE DESC LIMIT ${contentNum} OFFSET ${offset} -->
<!-- 	       		</when> -->
<!-- 	       	</choose>  -->
<!--     </select> -->
    
    <select id="selectContentListLen" parameterType="paramMap" resultType="resultMap">
    	SELECT
    		COUNT(*) TOTAL_CNT
    	FROM
    		(
    		<if test="contentViewType == null or (contentViewType != null and (contentViewType.equalsIgnoreCase('Image') or contentViewType.equalsIgnoreCase('Both')))">
			    SELECT
			    	 ID
			    	,TITLE
			    	,CONTENT
			    	,FILENAME
			    	,FILEPATH
			    	,UDATE
			    	,IDX
			    	,TABNAME
			    	,LATITUDE
			    	,LONGITUDE
			    	,NULL AS THUMBNAIL
			    	,NULL AS ORIGINNAME
			    	,'GeoVideo' AS DATAKIND
			    	,SHARETYPE
			    FROM
			    	TEST_IMAGE_CONTENT
			 </if>
			 <if test="contentViewType == null or (contentViewType != null and contentViewType.equalsIgnoreCase('Both'))">
			    UNION
			 </if>
			 <if test="contentViewType == null or (contentViewType != null and (contentViewType.equalsIgnoreCase('Video') or contentViewType.equalsIgnoreCase('Both')))">
			    SELECT
			    	 ID
			    	,TITLE
			    	,CONTENT
			    	,FILENAME
			    	,FILEPATH
			    	,UDATE
			    	,IDX
			    	,TABNAME
			    	,LATITUDE
			    	,LONGITUDE
			    	,THUMBNAIL
			    	,ORIGINNAME
			    	,'GeoVideo' AS DATAKIND
			    	,SHARETYPE
			    FROM
			    	TEST_VIDEO_CONTENT
			 </if>
			 ) TEST_CONTENT
		WHERE
			1 = 1
		AND
	    	(
	    		ID = '${loginId}'
	    	<if test="myContent == null || (myContent != null and !myContent.equalsIgnoreCase('Y'))">
	    	OR 
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			'${loginId}' = 
	    			(
	    				SELECT 
	    					ID 
	    				FROM 
	    					TEST_GEOCMS_SHARE 
	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
	    				WHERE 
	    					SHAREKIND = 'GeoCMS' 
	    				AND
	    					SHAREIDX = IDX
	    			)
	    		)
	    	 </if>
	    	)
		<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All')">
			AND
				TABNAME = '${tabName}'
		</if>
    </select>
    
    <select id="selectImageList" parameterType="paramMap" resultType="resultMap">
		SELECT 
			 ID
			,TITLE
			,CONTENT
			,FILENAME
			,FILEPATH
			,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE
			,IDX
			,TABNAME
			,LATITUDE
			,LONGITUDE
			,NULL AS THUMBNAIL
			,NULL AS ORIGINNAME
			,'GeoPhoto' AS DATAKIND
			,SHARETYPE
		FROM 
			TEST_IMAGE_CONTENT
		WHERE
			1 = 1
		AND
	    	(	
	    		ID = '${loginId}'
	    	<if test="myContent == null || (myContent != null and !myContent.equalsIgnoreCase('Y'))">
	    	OR
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			'${loginId}' = 
	    			(
	    				SELECT 
	    					ID 
	    				FROM 
	    					TEST_GEOCMS_SHARE 
	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
	    				WHERE 
	    					SHAREKIND = 'GeoPhoto' 
	    				AND
	    					SHAREIDX = IDX
	    			)
	    		)
	    	 </if>
	    	)
	    	
			<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All') and type != null and !type.equalsIgnoreCase('latest')">
				AND
					TABNAME = '${tabName}'
			</if>
			<if test="type != null and type.equalsIgnoreCase('marker')">
				AND 
		 			LATITUDE IS NOT NULL 
		 		AND  
		 			LONGITUDE IS NOT NULL
		 		AND 
		 			LATITUDE != 0
		 		AND 
		 			LONGITUDE != 0
		 	</if>
		 	<if test="idx != null and !idx.equalsIgnoreCase('')">
		 		AND
		 			IDX = ${idx}
			</if>
		 
		 	<choose>
		 		<when test="(pageNum != null and pageNum == 1) or(type != null and type.equalsIgnoreCase('latest'))">
					ORDER BY idx DESC LIMIT ${contentNum}
				</when>
				<when test="type != null and (!type.equalsIgnoreCase('marker') and !type.equalsIgnoreCase('one'))">
					ORDER BY idx DESC LIMIT ${contentNum} OFFSET ${offset}
				</when>
		 	</choose>
    </select>
    
    <select id="selectImageListLen" parameterType="paramMap" resultType="resultMap">
    	SELECT 
			COUNT(*) TOTAL_CNT
		FROM 
			TEST_IMAGE_CONTENT
		WHERE
			1 = 1
		AND
	    	(
	    		ID = '${loginId}'
	    	<if test="myContent == null || (myContent != null and !myContent.equalsIgnoreCase('Y'))">
	    	OR 
	    		(SELECT TYPE FROM geocms_user WHERE id = '${loginId}') = 'ADMIN'
	    	OR
	    		SHARETYPE = 1
	    	OR 
	    		(
	    			SHARETYPE = 2
	    		AND 
	    			'${loginId}' = 
	    			(
	    				SELECT 
	    					ID 
	    				FROM 
	    					TEST_GEOCMS_SHARE 
	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID
	    				WHERE 
	    					SHAREKIND = 'GeoPhoto' 
	    				AND  
	    					SHAREIDX = IDX
	    			)
	    		)
	    	 </if>
	    	)	
	    	
			<if test="tabName != null and tabName != '' and !tabName.equalsIgnoreCase('All')">
				AND
					TABNAME = '${tabName}'
			</if>
    </select>
    
    <insert id="insertImage" parameterType="paramMap" useGeneratedKeys="true" keyProperty="idx">
        INSERT INTO TEST_IMAGE_CONTENT
        (
        	 ID
        	,TITLE
        	,CONTENT
        	,FILENAME
        	,FILEPATH
        	,LONGITUDE
        	,LATITUDE
        	,RDATE
        	,UDATE
        	,TABNAME
        	,SHARETYPE
        )
        VALUES
        (
        	 '${loginId}'
        	,'${title}'
        	,'${content}'
        	,'${filesStr}'
        	,'${filePath}'
        	, ${longitude}
        	, ${latitude}
        	, NOW()
        	, NOW()
        	,'${tabName}'
        	, ${shareType}
        )
        <selectKey keyProperty="idx" resultType="int" order="AFTER">
        	SELECT LAST_INSERT_ID()
   		</selectKey>
    </insert>
    
    <update id="updateImage" parameterType="paramMap">
    	UPDATE
    		TEST_IMAGE_CONTENT
    	SET
    		 TITLE			= '${title}'
    		,CONTENT		= '${content}'
    		,TABNAME		= '${tabName}'
    		,UDATE			=  NOW()
    		,SHARETYPE		=  ${shareType}
    		,XMLDATA		= '${xmlData}'
    	WHERE 
    		1 = 1
    	AND
    		IDX = ${idx}
    </update>
    
    <delete id="deleteImage">
    	DELETE
    		FROM
    			TEST_IMAGE_CONTENT
    		WHERE
    			IDX = ${idx}
    		AND
    			ID = '${loginId}'
    </delete>
    
    <update id="updateXmlData" parameterType="paramMap">
    	UPDATE
    		TEST_IMAGE_CONTENT
    	SET
    		 XMLDATA		= '${xmlData}'
    	WHERE 
    		1 = 1
    	AND
    		IDX = ${idx}
    </update>
    
    <insert id="insertShare" parameterType="paramMap">
        INSERT INTO TEST_GEOCMS_SHARE
        (
        	 UID
        	,SHAREIDX
        	,SHAREKIND
        )
        VALUES
        <foreach collection="shareTList" item="shareTList" separator=" , ">
        	(
        	 ${shareTList}
        	,${shareIdx}
        	,'${shareKind}'
        	)
        </foreach>
    </insert>
    
    <delete id="deleteShare">
    	DELETE
    		FROM
    			TEST_GEOCMS_SHARE
    		WHERE
    			1 = 1
    		AND
    			SHAREIDX = ${shareIdx}
    		<if test="shareTList != null">
    			AND UID IN (
					<foreach collection="shareTList" item="shareTList" separator=" , ">
			        	 ${shareTList}
			        </foreach>
			        )
    		</if>
    		AND
    			SHAREKIND = '${shareKind}'
    </delete>
    
    <select id="selectShareUserList" parameterType="paramMap" resultType="resultMap">
    	SELECT
    		 TGS.IDX
    		,TGS.UID
    		,TGS.SHAREIDX
    		,TGS.SHAREKIND
    		,GU.ID
    	FROM
    		TEST_GEOCMS_SHARE TGS
    	LEFT JOIN GEOCMS_USER GU ON GU.UID = TGS.UID
    	WHERE
    		1 = 1
    	AND
    		TGS.SHAREKIND = '${shareKind}'
    	AND
    		TGS.SHAREIDX = ${shareIdx}
    </select>
    
<!--     <select id="selectProjectList" parameterType="paramMap" resultType="resultMap"> -->
<!-- 	    SELECT  -->
<!-- 			 ID -->
<!--         	,PROJECTNAME -->
<!--         	,IDX -->
<!--         	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!--         	,SHARETYPE -->
<!-- 		FROM  -->
<!-- 			TEST_PROJECT_CONTENT -->
<!-- 		WHERE -->
<!-- 	    	1 = 1 -->
<!-- 	    AND -->
<!-- 	    	( -->
<!-- 	    		ID = '${loginId}'  -->
<!-- 	    	OR  -->
<!-- 	    		SHARETYPE = 1 -->
<!-- 	    	OR  -->
<!-- 	    		( -->
<!-- 	    			SHARETYPE = 2 AND '${loginId}' =  -->
<!-- 	    			( -->
<!-- 	    				SELECT  -->
<!-- 	    					ID  -->
<!-- 	    				FROM  -->
<!-- 	    					TEST_GEOCMS_SHARE  -->
<!-- 	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID -->
<!-- 	    				WHERE  -->
<!-- 	    					SHAREKIND = 'GeoProject'  -->
<!-- 	    				AND  -->
<!-- 	    					SHAREIDX = TEST_PROJECT_CONTENT.IDX -->
<!-- 	    			) -->
<!-- 	    		) -->
<!-- 	    	) -->
<!--     </select> -->
    
<!--     <select id="selectProjectListLen" parameterType="paramMap" resultType="resultMap"> -->
<!-- 	    SELECT  -->
<!-- 			COUNT(*) TOTAL_CNT -->
<!-- 		FROM  -->
<!-- 			TEST_PROJECT_CONTENT -->
<!-- 		WHERE -->
<!-- 	    	1 = 1 -->
<!-- 	    AND -->
<!-- 	    	( -->
<!-- 	    		ID = '${loginId}'  -->
<!-- 	    	OR  -->
<!-- 	    		SHARETYPE = 1 -->
<!-- 	    	OR  -->
<!-- 	    		( -->
<!-- 	    			SHARETYPE = 2 AND '${loginId}' =  -->
<!-- 	    			( -->
<!-- 	    				SELECT  -->
<!-- 	    					ID  -->
<!-- 	    				FROM  -->
<!-- 	    					TEST_GEOCMS_SHARE  -->
<!-- 	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID -->
<!-- 	    				WHERE  -->
<!-- 	    					SHAREKIND = 'GeoProject'  -->
<!-- 	    				AND  -->
<!-- 	    					SHAREIDX = TEST_PROJECT_CONTENT.IDX -->
<!-- 	    			) -->
<!-- 	    		) -->
<!-- 	    	) -->
<!--     </select> -->
    
<!--     <insert id="insertProject" parameterType="paramMap" useGeneratedKeys="true" keyProperty="idx"> -->
<!--         INSERT INTO TEST_PROJECT_CONTENT -->
<!--         ( -->
<!--         	 ID -->
<!--         	,PROJECTNAME -->
<!--         	,UDATE -->
<!--         	,SHARE -->
<!--         ) -->
<!--         VALUES -->
<!--         ( -->
<!--         	 '${loginId}' -->
<!--         	,'${projectName}' -->
<!--         	, NOW() -->
<!--         	,'${share}' -->
<!--         ) -->
<!--         <selectKey keyProperty="idx" resultType="int" order="AFTER"> -->
<!--         	SELECT LAST_INSERT_ID() -->
<!--    		</selectKey> -->
<!--     </insert> -->
    
<!--     <select id="selectProjectContentList" parameterType="paramMap" resultType="resultMap"> -->
<!--     	SELECT  -->
<!--     		* -->
<!--     		,TEST_PROJECT_CONTENT.PROJECTNAME 					PROJECTNAME -->
<!--     		,TEST_PROJECT_CONTENT.SHARE							PROJECTSHARE -->
<!--     		,DATE_FORMAT(TEST_PROJECT_CONTENT.UDATE,'%Y-%m-%d')	PROJECTUDATE -->
<!--     	FROM( -->
<!--    		<if test="projectType != null and (projectType.equalsIgnoreCase('image') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,NULL AS THUMBNAIL -->
<!-- 		    	,NULL AS ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoPhoto' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_IMAGE_CONTENT -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and projectType.equalsIgnoreCase('both')"> -->
<!-- 	  		UNION -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and (projectType.equalsIgnoreCase('video') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,THUMBNAIL -->
<!-- 		    	,ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoVideo' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_VIDEO_CONTENT -->
<!-- 	    </if> -->
<!-- 	    ) CONTENT_TABLE -->
<!-- 	    LEFT JOIN TEST_PROJECT_CONTENT ON TEST_PROJECT_CONTENT.IDX = CONTENT_TABLE.PROJECTIDX  -->
<!-- 	    WHERE -->
<!-- 	    	1 = 1 -->
<!-- 	    AND -->
<!-- 	    	( -->
<!-- 	    		TEST_PROJECT_CONTENT.ID = '${loginId}'  -->
<!-- 	    	OR  -->
<!-- 	    		TEST_PROJECT_CONTENT.SHARE = 1 -->
<!-- 	    	OR  -->
<!-- 	    		( -->
<!-- 	    			TEST_PROJECT_CONTENT.SHARE = 2 AND '${loginId}' =  -->
<!-- 	    			( -->
<!-- 	    				SELECT  -->
<!-- 	    					ID  -->
<!-- 	    				FROM  -->
<!-- 	    					TEST_GEOCMS_SHARE  -->
<!-- 	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID -->
<!-- 	    				WHERE  -->
<!-- 	    					SHAREKIND = 'GeoProject'  -->
<!-- 	    				AND  -->
<!-- 	    					SHAREIDX = TEST_PROJECT_CONTENT.IDX -->
<!-- 	    			) -->
<!-- 	    		) -->
<!-- 	    	) -->
	    	
<!-- 	    <if test="projectIdx != null"> -->
<!-- 	    	AND TEST_PROJECT_CONTENT.IDX = ${projectIdx} -->
<!-- 	    </if> -->
<!-- 	    <choose> -->
<!-- 			<when test="pageNum != null and pageNum == 1"> -->
<!-- 				ORDER BY TEST_PROJECT_CONTENT.IDX, TEST_PROJECT_CONTENT.UDATE DESC LIMIT ${contentNum} -->
<!-- 			</when> -->
<!-- 			<otherwise> -->
<!-- 				ORDER BY TEST_PROJECT_CONTENT.IDX, TEST_PROJECT_CONTENT.UDATE DESC LIMIT ${contentNum} OFFSET ${offset} -->
<!-- 			</otherwise> -->
<!-- 		</choose> -->
<!--     </select> -->
    
<!--     <select id="selectProjectContentListLen" parameterType="paramMap" resultType="resultMap"> -->
<!--     	SELECT  -->
<!--     		COUNT(*) TOTAL_CNT -->
<!--     	FROM( -->
<!--    		<if test="projectType != null and (projectType.equalsIgnoreCase('image') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,NULL AS THUMBNAIL -->
<!-- 		    	,NULL AS ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoPhoto' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_IMAGE_CONTENT -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and projectType.equalsIgnoreCase('both')"> -->
<!-- 	  		UNION -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and (projectType.equalsIgnoreCase('video') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,THUMBNAIL -->
<!-- 		    	,ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoVideo' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_VIDEO_CONTENT -->
<!-- 	    </if> -->
<!-- 	    ) CONTENT_TABLE -->
<!-- 	    LEFT JOIN TEST_PROJECT_CONTENT ON TEST_PROJECT_CONTENT.IDX = CONTENT_TABLE.PROJECTIDX  -->
<!-- 	    WHERE -->
<!-- 	    	1 = 1 -->
<!-- 	    AND -->
<!-- 	    	( -->
<!-- 	    		TEST_PROJECT_CONTENT.ID = '${loginId}'  -->
<!-- 	    	OR  -->
<!-- 	    		TEST_PROJECT_CONTENT.SHARE = 1 -->
<!-- 	    	OR  -->
<!-- 	    		( -->
<!-- 	    			TEST_PROJECT_CONTENT.SHARE = 2 AND '${loginId}' =  -->
<!-- 	    			( -->
<!-- 	    				SELECT  -->
<!-- 	    					ID  -->
<!-- 	    				FROM  -->
<!-- 	    					TEST_GEOCMS_SHARE  -->
<!-- 	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID -->
<!-- 	    				WHERE  -->
<!-- 	    					SHAREKIND = 'GeoProject'  -->
<!-- 	    				AND  -->
<!-- 	    					SHAREIDX = TEST_PROJECT_CONTENT.IDX -->
<!-- 	    			) -->
<!-- 	    		) -->
<!-- 	    	) -->
	    	
<!-- 	    <if test="projectIdx != null"> -->
<!-- 	    	AND TEST_PROJECT_CONTENT.IDX = ${projectIdx} -->
<!-- 	    </if> -->
<!--     </select> -->
    
<!--     <select id="selectProjectContentList" parameterType="paramMap" resultType="resultMap"> -->
<!--     	SELECT  -->
<!--     		* -->
<!--     		,TEST_PROJECT_CONTENT.PROJECTNAME 					PROJECTNAME -->
<!--     		,TEST_PROJECT_CONTENT.SHARE							PROJECTSHARE -->
<!--     		,DATE_FORMAT(TEST_PROJECT_CONTENT.UDATE,'%Y-%m-%d')	PROJECTUDATE -->
<!--     	FROM( -->
<!--    		<if test="projectType != null and (projectType.equalsIgnoreCase('image') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,NULL AS THUMBNAIL -->
<!-- 		    	,NULL AS ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoPhoto' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_IMAGE_CONTENT -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and projectType.equalsIgnoreCase('both')"> -->
<!-- 	  		UNION -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and (projectType.equalsIgnoreCase('video') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,THUMBNAIL -->
<!-- 		    	,ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoVideo' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_VIDEO_CONTENT -->
<!-- 	    </if> -->
<!-- 	    ) CONTENT_TABLE -->
<!-- 	    LEFT JOIN TEST_PROJECT_CONTENT ON TEST_PROJECT_CONTENT.IDX = CONTENT_TABLE.PROJECTIDX  -->
<!-- 	    WHERE -->
<!-- 	    	1 = 1 -->
<!-- 	    AND -->
<!-- 	    	( -->
<!-- 	    		TEST_PROJECT_CONTENT.ID = '${loginId}'  -->
<!-- 	    	OR  -->
<!-- 	    		TEST_PROJECT_CONTENT.SHARE = 1 -->
<!-- 	    	OR  -->
<!-- 	    		( -->
<!-- 	    			TEST_PROJECT_CONTENT.SHARE = 2 AND '${loginId}' =  -->
<!-- 	    			( -->
<!-- 	    				SELECT  -->
<!-- 	    					ID  -->
<!-- 	    				FROM  -->
<!-- 	    					TEST_GEOCMS_SHARE  -->
<!-- 	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID -->
<!-- 	    				WHERE  -->
<!-- 	    					SHAREKIND = 'GeoProject'  -->
<!-- 	    				AND  -->
<!-- 	    					SHAREIDX = TEST_PROJECT_CONTENT.IDX -->
<!-- 	    			) -->
<!-- 	    		) -->
<!-- 	    	) -->
	    	
<!-- 	    <if test="projectIdx != null"> -->
<!-- 	    	AND TEST_PROJECT_CONTENT.IDX = ${projectIdx} -->
<!-- 	    </if> -->
<!-- 	    <if test="projectGroup != null and projectGroup.equalsIgnoreCase('Y')"> -->
<!-- 	   		GROUP BY -->
<!-- 	    		TEST_PROJECT_CONTENT.IDX -->
<!-- 	    </if> -->
<!-- 	    <choose> -->
<!-- 			<when test="pageNum != null and pageNum == 1"> -->
<!-- 				ORDER BY TEST_PROJECT_CONTENT.IDX, TEST_PROJECT_CONTENT.UDATE DESC LIMIT ${contentNum} -->
<!-- 			</when> -->
<!-- 			<when test="projectGroup != null and projectGroup.equalsIgnoreCase('Y')"> -->
<!-- 				ORDER BY TEST_PROJECT_CONTENT.IDX, TEST_PROJECT_CONTENT.UDATE DESC -->
<!-- 			</when> -->
<!-- 			<otherwise> -->
<!-- 				ORDER BY TEST_PROJECT_CONTENT.IDX, TEST_PROJECT_CONTENT.UDATE DESC LIMIT ${contentNum} OFFSET ${offset} -->
<!-- 			</otherwise> -->
<!-- 		</choose> -->
<!--     </select> -->
    
<!--     <select id="selectProjectContentListLen" parameterType="paramMap" resultType="resultMap"> -->
<!--     	SELECT  -->
<!--     		COUNT(*) TOTAL_CNT -->
<!--     	FROM( -->
<!--    		<if test="projectType != null and (projectType.equalsIgnoreCase('image') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,NULL AS THUMBNAIL -->
<!-- 		    	,NULL AS ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoPhoto' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_IMAGE_CONTENT -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and projectType.equalsIgnoreCase('both')"> -->
<!-- 	  		UNION -->
<!-- 	    </if> -->
<!-- 	    <if test="projectType != null and (projectType.equalsIgnoreCase('video') or projectType.equalsIgnoreCase('both'))"> -->
<!-- 		    SELECT -->
<!-- 		    	 ID -->
<!-- 		    	,TITLE -->
<!-- 		    	,CONTENT -->
<!-- 		    	,FILENAME -->
<!-- 		    	,DATE_FORMAT(UDATE,'%Y-%m-%d') U_DATE -->
<!-- 		    	,IDX -->
<!-- 		    	,TABNAME -->
<!-- 		    	,LATITUDE -->
<!-- 		    	,LONGITUDE -->
<!-- 		    	,THUMBNAIL -->
<!-- 		    	,ORIGINNAME -->
<!-- 		    	,PROJECTIDX -->
<!-- 		    	,'GeoVideo' AS DATAKIND -->
<!-- 		    FROM -->
<!-- 		    	TEST_VIDEO_CONTENT -->
<!-- 	    </if> -->
<!-- 	    ) CONTENT_TABLE -->
<!-- 	    LEFT JOIN TEST_PROJECT_CONTENT ON TEST_PROJECT_CONTENT.IDX = CONTENT_TABLE.PROJECTIDX  -->
<!-- 	    WHERE -->
<!-- 	    	1 = 1 -->
<!-- 	    AND -->
<!-- 	    	( -->
<!-- 	    		TEST_PROJECT_CONTENT.ID = '${loginId}'  -->
<!-- 	    	OR  -->
<!-- 	    		TEST_PROJECT_CONTENT.SHARE = 1 -->
<!-- 	    	OR  -->
<!-- 	    		( -->
<!-- 	    			TEST_PROJECT_CONTENT.SHARE = 2  -->
<!-- 	    		AND  -->
<!-- 	    			'${loginId}' =  -->
<!-- 	    			( -->
<!-- 	    				SELECT  -->
<!-- 	    					ID  -->
<!-- 	    				FROM  -->
<!-- 	    					TEST_GEOCMS_SHARE  -->
<!-- 	    				LEFT JOIN GEOCMS_USER ON GEOCMS_USER.UID = TEST_GEOCMS_SHARE.UID -->
<!-- 	    				WHERE  -->
<!-- 	    					SHAREKIND = 'GeoProject'  -->
<!-- 	    				AND   -->
<!-- 	    					SHAREIDX = TEST_PROJECT_CONTENT.IDX -->
<!-- 	    			) -->
<!-- 	    		) -->
<!-- 	    	) -->
	    	
<!-- 	    <if test="projectIdx != null"> -->
<!-- 	    	AND TEST_PROJECT_CONTENT.IDX = ${projectIdx} -->
<!-- 	    </if> -->
<!--     </select> -->
    
</mapper>